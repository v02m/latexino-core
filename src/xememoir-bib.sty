% ======================================================================
% üìö XEMEMOIR-BIB ‚Äî –ú–û–î–£–õ–¨ –ë–ò–ë–õ–ò–û–ì–†–ê–§–ò–ò (–ì–û–°–¢ 7.0.5‚Äì2008)
% ----------------------------------------------------------------------
% –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å memoir, polyglossia, XeLaTeX –∏ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º –ø–∞–∫–µ—Ç–æ–º xememoir
%%% Refactor Branch
%%% Author: Valery
%%% Date: 2025-11-01
%%% ===========================

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{xememoir-bib}[2025/11/01 GOST bibliography for memoir]

% ----------------------------------------------------------------------
% üîß –ë–∞–∑–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
% ----------------------------------------------------------------------
\RequirePackage{csquotes} % –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —è–∑—ã–∫–æ–≤—ã—Ö –∫–∞–≤—ã—á–µ–∫

% ----------------------------------------------------------------------
% üß© –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ biblatex-gost
% ----------------------------------------------------------------------
% biblatex-gost –Ω–µ –∏–º–µ–µ—Ç biblatex-gost.sty, –∞ —Å–æ–¥–µ—Ä–∂–∏—Ç biblatex-gost.def
\newif\if@xem@hasgost
\IfFileExists{biblatex-gost.def}{%
  \@xem@hasgosttrue
  \typeout{[xememoir-bib] Found biblatex-gost.def ‚Äî using GOST style.}%
}{%
  \@xem@hasgostfalse
  \PackageWarning{xememoir-bib}{Package 'biblatex-gost' not found. Using fallback style 'numeric'.}%
}
% ----------------------------------------------------------------------
% ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ biblatex
% ----------------------------------------------------------------------
\if@xem@hasgost
\RequirePackage[
  backend=biber,
  style=gost-numeric,
  language=auto,
  bibencoding=utf8,
  sorting=nyt,
  autocite=inline,
  doi=true,
  url=true,
  isbn=false,
  dashed=false,
  maxbibnames=99
]{biblatex}
\else
% fallback –µ—Å–ª–∏ GOST –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
\RequirePackage[
  backend=biber,
  style=numeric,
  language=auto,
  bibencoding=utf8,
  sorting=nyt,
  doi=true,
  url=true,
  maxbibnames=99
]{biblatex}
\fi

% –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –±–∏–±–ª–∏–æ–≥—Ä–∞—Ñ–∏–∏
\renewcommand*{\bibfont}{\normalfont\small}
\setlength{\bibitemsep}{0pt}
\setlength{\bibhang}{1.25cm}
\AtBeginBibliography{%
  \setlength{\bibitemindent}{0pt}%
}

\makeatletter
\def\blx@maxcitenames{99}
\makeatother

% ----------------------------------------------------------------------
% üí° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
% ----------------------------------------------------------------------
% 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: \usepackage{xememoir-bib}
% 2. –í –¥–æ–∫—É–º–µ–Ω—Ç–µ:
%      \addbibresource{myrefs.bib}
%      \cite{key}, \autocite{key}, \parencite{key}
%      \printbibliography[title={–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã}]
% ----------------------------------------------------------------------

\endinput
