% ===========================
% 📐 Настройка модуля таблиц (ГОСТ + memoir)
% ===========================
% Совместимо с memoir, не использует caption, следует ГОСТ 2.105-95

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{tablesetup}[2025/10/25 GOST-compliant tables for memoir]

% Базовые пакеты
\RequirePackage{array}       % Расширенные столбцы (>{...}, <{...})
%\RequirePackage{tabularx}    % Автоширина столбцов ← НЕ НУЖНО, уже в xltabular
\RequirePackage{booktabs}    % Качественные линии: \toprule, \midrule, \bottomrule
\RequirePackage{dcolumn}     % Выравнивание по десятичной точке
\RequirePackage{multirow}    % Объединение ячеек по вертикали
\RequirePackage{makecell}    % Переносы в ячейках: \makecell, \thead
\RequirePackage{xltabular}   % longtable + tabularx для таблиц на несколько страниц
% Этот пакет включает в себя \RequirePackage{longtable} поэтому  отдельно загружать его не надо
% так как уже загружен через xltabular

% Настройки под ГОСТ:
% - Нет вертикальных линий,
% - Только \toprule, \midrule, \bottomrule,
% - Подписи сверху (как в ГОСТ).

% ======================================================================
% 📐 Альбомные таблицы
% ======================================================================
% Для поворота отдельных таблиц (рекомендуется для книг)
\RequirePackage{rotating} % Альбомные таблицы и рисунки ← ОБЯЗАТЕЛЬНО!

% ======================================================================
% 📏 Настройка подписей через memoir (ГОСТ-совместимо)
% ======================================================================
% ГОСТ 2.105-95: "Таблица 1. Название" (точка + пробел)
% Улучшенные подписи через memoir (НЕ через caption!)
% Разделитель: точка + пробел (ГОСТ!)
\captiondelim{. }           % Разделитель между "Таблица N" и текстом
\captionnamefont{\bfseries} % "Таблица 1" — жирным
\captiontitlefont{\normalfont} % Текст — обычным шрифтом
\captionstyle{\centering}   % Подпись по центру (можно заменить на \raggedright)

% Пользовательские команды (латиница для совместимости)
\newcommand{\newrow}{\tabularnewline\midrule} % Новая строка + линия
\newcommand{\topcaption}[1]{\caption{#1}\vspace{6pt}} % Подпись сверху

%Этот блок перенесен из graphicssetup
% Для альбомных таблиц:
%   \usepackage{rotating}      % → \begin{sidewaystable}...\end{sidewaystable}
%   \usepackage{longtable}     % → таблицы на несколько страниц

% Для полностраничного альбома (используй в .tex при необходимости)
% \RequirePackage{pdflscape}  % ← НЕ подключаем по умолчанию

% Удобные шаблоны
\newenvironment{albtable}[1][]{%
  \begin{sidewaystable}[ht]%
    \centering%
    \ifx&#1&\else\caption{#1}\fi%
  }{%
  \end{sidewaystable}%
}

% sidewaystable автоматически:
% поворачивает таблицу,
% оставляет номер страницы вертикальным,
% совместим с hyperref и memoir.

% Пример использования:
% \begin{albtable}[Сравнение параметров]
%   \begin{xltabular}{\textheight}{lX}
%     \toprule
%     Параметр & Значение \\
%     \midrule
%     Температура & 25\,\si{\celsius} \\
%     % ... много строк ...
%     \bottomrule
%   \end{xltabular}
% \end{albtable}

% Пример таблицы:
% \begin{table}[ht]
%   \centering
%   \topcaption{Пример таблицы по ГОСТ}
%   \begin{tabularx}{\textwidth}{XX}
%     \toprule
%     Колонка 1 & Колонка 2 \\
%     \midrule
%     Данные & Данные \\
%     \newrow
%     Ещё данные & Ещё данные \\
%     \bottomrule
%   \end{tabularx}
% \end{table}

% Пример использования:
% \begin{table}[ht]
%   \centering
%   \caption{Сравнение шрифтов}
%   \begin{tabularx}{\textwidth}{lX}
%     \toprule
%     Шрифт & Описание \\
%     \midrule
%     Times New Roman & Стандартный для ГОСТ \\
%     \newrow
%     Liberation & Свободная альтернатива \\
%     \bottomrule
%   \end{tabularx}
% \end{table}

% Для таблиц на несколько страниц:
% \begin{xltabular}{\textwidth}{lX}
%   \caption{Длинная таблица} \\
%   \toprule
%   Параметр & Значение \\
%   \midrule
%   \endfirsthead
%
%   \multicolumn{2}{c}{{\bfseries Продолжение таблицы}} \\
%   \toprule
%   Параметр & Значение \\
%   \midrule
%   \endhead
%
%   \bottomrule
%   \endlastfoot
%
%   Температура & 25\,\si{\celsius} \\
%   % ... много строк ...
% \end{xltabular}

\endinput
