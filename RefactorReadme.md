## Branch: refactor/xememoir-structure

### Цель

Рефакторинг архитектуры пакета `xememoir.sty` с сохранением всех пользовательских комментариев и добавлением системных аннотаций.  
Основная задача — подготовить основу для дальнейшей модульности и безопасной обработки опций (`kvoptions`), не изменяя текущее поведение пакета.

### Что сделано

- Сохранены все оригинальные комментарии.
- Добавлены структурные заголовки для навигации по коду.
- Добавлены пояснения (`%% NOTE:` / `%% TODO:` / `%% INFO:`) к ключевым блокам.
- Приведён единый стиль объявления опций.
- Исправлены незначительные ошибки форматирования.
- Подготовлены подсказки для дальнейшего внедрения:
  - системы `kvoptions`;
  - вывода активных флагов в конце пакета;
  - тестовых примеров в комментариях.

### Что не изменялось

- Функциональная логика пакета и поведение опций.
- Взаимодействие с `hyperref`, `microtype` и другими модулями.

### Следующий этап

- Добавить блок `\AtEndOfPackage` с диагностикой активных флагов.
- Перейти на `kvoptions` для унифицированной обработки `key=value`.
- Реализовать тестовые примеры (`example.tex`) и CI-проверку сборки.

Общие рекомендации для нового рефакторинга:

Централизовать флаги: создать один модуль flags.sty, где будут все флаги профилей: шрифты, макеты, графика, списки, таблицы. Это уменьшит дублирование и вложенные \if.

Унификация заголовков пакетов: каждый пакет должен иметь \ProvidesPackage{<name>}[2025/11/01 Refactored by Valery].

Создать шаблон функции для профиля: вместо дублирования \chapterstyle, \pagestyle, \setlrmarginsandblock сделать макрос \ApplyBookProfile{<profile>}.

Проверка зависимостей: каждый модуль должен проверять, что нужный пакет установлен (xcolor, tikz, polyglossia и т.д.).

Минимизация дублирования: объединить повторяющиеся конструкции в вспомогательные макросы.

Документация: оставить подробные комментарии, но убрать повторяющиеся закомментированные блоки, которые создают шум.

Fallback: для каждого модуля сделать разумный fallback, чтобы документ компилировался даже если профиль не выбран.
